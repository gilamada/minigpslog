//###########################################################################
//
// FILE:    st7565.c
//
// TITLE:   显示程序
//
// DESCRIPTION:			
//			功能菜单，图形显示
//
//###########################################################################
//  Release: 
//  Date:		 2008.11.28
//	Modified:	 2008.11.28
//###########################################################################

#include "DSP2833x_Device.h"     // DSP2833x Headerfile Include File
#include "DSP2833x_Examples.h"   // DSP2833x Examples Include File


#define	 dat_set	GpioDataRegs.GPADAT.bit.GPIO1 = 1
#define	 dat_clr   	GpioDataRegs.GPADAT.bit.GPIO1 = 0
#define	 clk_set	GpioDataRegs.GPADAT.bit.GPIO5 = 1
#define	 clk_clr	GpioDataRegs.GPADAT.bit.GPIO5 = 0
#define	 lcd_a0		GpioDataRegs.GPADAT.bit.GPIO4
#define	 lcd_cs		GpioDataRegs.GPADAT.bit.GPIO3
#define	 lcd_rst	GpioDataRegs.GPADAT.bit.GPIO2


#define st_fg 0
#define fn_fg 1
#define rn_fg 2
#define er_fg 3

#define fun_fg 2
#define set_fg 1
#define run_fg 0

#define te_fg 1//温度+流量
#define ft_fg 2//时间+流量
#define sf_fg 3//设置值+

void lcd_Init(void);
void lcd_w(Uint16 sel,Uint16 dat);
void display(void);

void disp_bmp(void);
void disp_num(Uint16 z,float w);
void disp_bsf(Uint16 ud,Uint16 sel);
void disp_lf(Uint16 z,Uint16 sel);
void disp_per(Uint16 perc);
void disp_pic(Uint16 sel);
void disp_dw(Uint16 ud,Uint16 sel);
void disp_letter(Uint16 ud,Uint16 sel);



extern Uint16 mod;
extern Uint16 pic;

extern Uint16 flow;
extern int time;
extern int rev;
extern Uint16 errer;

extern Uint16 menu;
extern Uint16 status;
extern Uint16 run_i;

extern float32 zz;

Uint16 tab1[1024]=
{

0xFF,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,
0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,
0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,
0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,
0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,
0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,
0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,
0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0x01,0x25,0x19,0x7F,0x19,0x25,0x01,0xFF,
0xFF,0x00,0x04,0x95,0x0E,0x0E,0x95,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x00,0xC0,0xE0,0x20,
0x60,0xE0,0xC0,0x00,0xC0,0xF0,0x90,0x10,0xB0,0xF0,0x00,0x18,0x38,0xF8,0xC0,0xF8,
0x78,0x08,0x00,0xF0,0xB8,0xC8,0xD8,0xF8,0x90,0x00,0x00,0x80,0x60,0xF0,0xF8,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0xF8,0xF8,0x08,0x10,0xF0,0xE0,0x00,
0xE0,0x30,0x10,0x10,0xF0,0xC0,0x00,0xC0,0x60,0xE0,0xE0,0x40,0xC0,0xC0,0x00,0x80,
0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x95,0x0E,0x0E,0x95,0x04,0x00,0xFF,
0xFF,0x00,0x02,0x4A,0x87,0x87,0x4A,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x07,0x1F,0x7E,0xF0,0xC0,0x80,0x83,0xC3,0xF0,
0xD8,0x47,0x63,0x70,0x18,0x3F,0x63,0x63,0x63,0x3F,0x1C,0x20,0x30,0x3C,0x07,0x3F,
0x3C,0x30,0x30,0x0F,0x1D,0x30,0x30,0x1F,0x1F,0x00,0x06,0x07,0x16,0x1F,0x1F,0x16,
0x16,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x3E,0x3F,0x31,0x30,0x18,0x1F,0x07,0x0F,
0x3F,0x20,0x60,0x30,0x3F,0x1F,0x00,0x40,0x78,0xFF,0xC7,0x00,0x80,0xE1,0x07,0x0F,
0x1D,0xF8,0xE1,0x07,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x4A,0x87,0x87,0x4A,0x02,0x00,0xFF,
0xFF,0x00,0x81,0xA5,0xC3,0xC3,0xA5,0x81,0x00,0x00,0x00,0x20,0xC0,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x01,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0xE0,0x20,0x20,
0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
0xC0,0x20,0xC0,0xE0,0xE0,0xA0,0xC0,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x03,
0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x81,0xA5,0xC3,0xC3,0xA5,0x81,0x00,0xFF,
0xFF,0x00,0x40,0x52,0xE1,0xE1,0x52,0x40,0x00,0x00,0x00,0x00,0x00,0x03,0x04,0x18,
0x20,0x40,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0xC0,0x30,0x18,0x34,0xF4,0xCC,0x3C,0xFC,0xFC,0xFC,0xFF,0xFF,0xF1,0xE1,
0xBD,0x35,0xA9,0x11,0x11,0x11,0x91,0x61,0x32,0x6A,0xEA,0x9A,0x7A,0xFE,0xF9,0xF9,
0xF8,0xF0,0xEC,0x9E,0xB9,0xB8,0xDC,0xDC,0x5C,0xD5,0x5E,0xCA,0x4A,0x8C,0x88,0x0E,
0x18,0x18,0x10,0x20,0x20,0x40,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x60,0xD0,
0xD0,0x30,0xF0,0xF0,0xF0,0xF0,0xF0,0xE0,0xC0,0x00,0x01,0x02,0x04,0x08,0x10,0x20,
0x40,0x40,0x80,0x00,0x00,0x00,0x00,0x00,0x40,0x52,0xE1,0xE1,0x52,0x40,0x00,0xFF,
0xFF,0x00,0x20,0xA9,0x70,0x70,0xA9,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x0F,0x30,0x60,0xB0,0xBF,0xCF,0xF0,0xFF,0xFF,0xFF,0xFF,0x7F,0x3F,0x4F,
0x47,0x6F,0x7C,0x72,0x78,0x70,0x3F,0xC0,0x80,0xC0,0xFF,0x3F,0xC0,0xFF,0xFF,0xFF,
0xFF,0xFF,0x7F,0x3F,0xF7,0x86,0xA7,0xA7,0xA5,0xA7,0xAF,0xAE,0xAD,0x9E,0xBD,0xBF,
0xBD,0xBA,0xDC,0x98,0xB8,0xA8,0xA8,0xB9,0x26,0x22,0x22,0x22,0x3F,0x5E,0x4E,0x4E,
0x49,0x4F,0x48,0x1F,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0xA9,0x70,0x70,0xA9,0x20,0x00,0xFF,
0xFF,0x00,0x10,0x54,0x38,0x38,0x54,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x02,0x04,0x08,0x08,
0x10,0x10,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x02,0x02,0x03,0x03,0x03,0x03,0x03,
0x03,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
0x01,0x01,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x03,0x05,
0x05,0x07,0x07,0x07,0x07,0x07,0x07,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x54,0x38,0x38,0x54,0x10,0x00,0xFF,
0xFF,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,
0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,
0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,
0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,
0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,
0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,
0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,
0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0x80,0xA4,0x98,0xFE,0x98,0xA4,0x80,0xFF

};

Uint16 pic_f[4][14]={
//fn
{0xff,0xff,0x01,0xed,0xed,0xfd,0xfd,0xff,0x0f,0xef,0xef,0x0f,0xff,0xff},
//er
{0xff,0xff,0x01,0x6d,0x6d,0x6d,0xff,0x03,0xed,0xcd,0xad,0x73,0xff,0xff},
//st
{0xff,0xff,0xb3,0x6d,0x6d,0x9b,0xff,0xf7,0xf7,0x01,0x77,0xb7,0xff,0xff},
//rn
{0xff,0xff,0xff,0x01,0x01,0xff,0x01,0x7d,0xbb,0xd7,0xef,0xff,0xff,0xff}

};

Uint16 dc[20]={
0x3c,0x24,0x24,0xff,0x81,0x81,0x81,0x81,0x81,0x81,
0x81,0x81,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff

};


Uint16 lf[3][64]={
//run
{0xE0,0xC0,0x80,0xFE,0xFE,0x02,0x76,0xFA,0xFA,0xFA,
0x72,0x06,0xFE,0x02,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,
0x02,0xFE,0x02,0xE6,0x9E,0x7E,0xFE,0xFE,0x02,0xFE,
0xFE,0x00,
0x07,0x03,0x01,0x7F,0x7F,0x40,0x79,0x72,0x66,0x4E,
0x5E,0x5F,0x7F,0x70,0x6F,0x5F,0x5F,0x5F,0x5F,0x6F,
0x70,0x7F,0x40,0x7F,0x7F,0x7E,0x79,0x67,0x40,0x7F,
0x7F,0x00},
//set
{0xE0,0xC0,0x80,0xFE,0xFE,0x86,0x32,0x7A,0x7A,0x7A,
0x7A,0x72,0xE6,0xFE,0x02,0x7A,0x7A,0x7A,0x7A,0x7A,
0xFA,0xFE,0xFA,0xFA,0xFA,0x02,0xFA,0xFA,0xFA,0xFE,
0xFE,0x00,
0x07,0x03,0x01,0x7F,0x7F,0x67,0x4F,0x5F,0x5F,0x5F,
0x5F,0x4E,0x60,0x7F,0x40,0x5F,0x5F,0x5F,0x5F,0x5F,
0x5F,0x7F,0x7F,0x7F,0x7F,0x40,0x7F,0x7F,0x7F,0x7F,
0x7F,0x00},
//fun
{0xE0,0xC0,0x80,0xFE,0xFE,0x02,0x7A,0x7A,0x7A,0x7A,
0x7A,0xFA,0xFE,0x02,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,
0x02,0xFE,0x02,0xE6,0x9E,0x7E,0xFE,0xFE,0x02,0xFE,
0xFE,0x00,
0x07,0x03,0x01,0x7F,0x7F,0x40,0x7F,0x7F,0x7F,0x7F,
0x7F,0x7F,0x7F,0x70,0x67,0x4F,0x5F,0x5F,0x4F,0x67,
0x70,0x7F,0x40,0x7F,0x7F,0x7E,0x79,0x67,0x40,0x7F,
0x7F,0x00}

};



Uint16 bsf_run[5][96]={
//FL
{0x00,0xFE,0xFE,0x06,0x06,0x06,0x06,0x06,0x06,0x06,
0x06,0x06,0x06,0x06,0x00,0xFE,0xFE,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,
0x00,0xFF,0xFF,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
0x0C,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,
0x00,0x7F,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,0x60,0x60,0x60,
0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x63,
0x63,0x00},
//TE
{0x00,0x06,0x06,0x06,0x06,0x06,0x06,0xFE,0xFE,0x06,
0x06,0x06,0x06,0x06,0x06,0x00,0xFE,0xFE,0x06,0x06,
0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x00,0x00,0x00,
0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x18,0x18,
0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x00,0x00,
0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,0x60,0x60,
0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x00,0x66,
0x66,0x00},
//HU
{0x00,0xFE,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0xFE,0xFE,0x00,0xFE,0xFE,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,0x00,0x00,0x00,
0x00,0x00,
0x00,0xFF,0xFF,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
0x0C,0xFF,0xFF,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,
0x00,0x00,
0x00,0x7F,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x7F,0x7F,0x00,0x0F,0x1F,0x38,0x70,0x60,0x60,
0x60,0x60,0x60,0x70,0x38,0x1F,0x0F,0x00,0x00,0x66,
0x66,0x00},
//ST
{0x00,0x00,0x80,0xC0,0x40,0x40,0x40,0x40,0xC0,0x80,
0x00,0x00,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0xFE,
0xFE,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x00,0x00,
0x00,0x00,
0x00,0x1F,0x31,0x60,0x40,0x40,0x40,0x40,0xC0,0x81,
0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,
0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,
0x00,0x1C,0x30,0x60,0x40,0x40,0x40,0x40,0x60,0x31,
0x1F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,
0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x66,
0x66,0x00},
//SF
{0x00,0x00,0x80,0xC0,0x40,0x40,0x40,0x40,0xC0,0x80,
0x00,0x00,0x00,0xFE,0xFE,0x06,0x06,0x06,0x06,0x06,
0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x00,0x00,
0x00,0x00,
0x00,0x1F,0x31,0x60,0x40,0x40,0x40,0x40,0xC0,0x81,
0x07,0x00,0x00,0xFF,0xFF,0x0C,0x0C,0x0C,0x0C,0x0C,
0x0C,0x0C,0x0C,0x0C,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,
0x00,0x1C,0x30,0x60,0x40,0x40,0x40,0x40,0x60,0x31,
0x1F,0x00,0x00,0x7F,0x7F,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x66,
0x66,0x00}

};

Uint16 bsf_set[3][48]={
//Flow
{0x00,0xFE,0xFE,0x86,0x86,0x86,0x86,0x86,0x86,0x06,
0x06,0x00,0xFE,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,0x01,0x01,0x01,
0x01,0x01,0x01,0x00,0x00,0x00,0x7F,0x7F,0x60,0x60,
0x60,0x60,0x60,0x60,0x00,0x6C,0x6C,0x00},
//Time
{0x00,0x06,0x06,0x06,0x06,0xFE,0xFE,0x06,0x06,0x06,
0x06,0x00,0xFE,0xFE,0x86,0x86,0x86,0x86,0x86,0x06,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,
0x7F,0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,0x61,0x61,
0x61,0x61,0x61,0x60,0x00,0x6C,0x6C,0x00},
//Rev
{0x00,0xFE,0xFE,0xCC,0x86,0x86,0x86,0x86,0xCE,0xFC,
0x78,0x00,0x7E,0xFE,0x80,0x00,0x00,0x00,0x80,0xFE,
0x7E,0x00,0x00,0x00,0x00,0x7F,0x7F,0x06,0x0D,0x1D,
0x39,0x71,0x61,0x40,0x40,0x00,0x00,0x03,0x0F,0x3C,
0x70,0x3C,0x0F,0x03,0x00,0x6C,0x6C,0x00},
};


Uint16 dw[3][24]={
//slm
{0x00,0x00,0x66,0xC9,0x89,0x89,0x99,0x72,0x00,0xFF,
0x80,0x80,0x00,0xFE,0x01,0x01,0x01,0xFE,0x01,0x01,
0x01,0xFE,0x00,0x00},
//min
{0x00,0x00,0xFE,0x01,0x01,0x01,0xFE,0x01,0x01,0x01,
0xFE,0x00,0x00,0xFD,0x00,0x00,0xFE,0x01,0x01,0x01,
0x01,0xFE,0x00,0x00},
// 温度符号
{0x00,0x00,0x02,0x05,0x02,0x00,0x3C,0x42,0x81,0x81,
0x81,0x42,0x24,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00}

};

Uint16 menu_sel[8]={0xE0,0xC0,0x80,0x00,0x07,0x03,0x01,0x00};


//////////////////////////////////////////////////////

//数字阵列
Uint16 num[10][18]={
//0
{0x00,0xF8,0x0C,0x06,0x02,0x06,0x0C,0xF8,0x00,0x00,0x1F,0x30,0x60,0x40,0x60,0x30,0x1F,0x00},
//1
{0x00,0x00,0x08,0x0C,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x40,0x7F,0x40,0x40,0x00,0x00},
//2
{0x00,0x0C,0x06,0x02,0x02,0x82,0xC6,0x7C,0x00,0x00,0x78,0x4C,0x46,0x43,0x41,0x40,0x60,0x00},
//3
{0x00,0x0C,0x06,0x02,0x82,0xC2,0x66,0x3C,0x00,0x00,0x30,0x60,0x40,0x40,0x41,0x63,0x3E,0x00},
//4
{0x00,0xC0,0x60,0x30,0x18,0x0C,0xFE,0x00,0x00,0x00,0x03,0x02,0x02,0x02,0x02,0x7F,0x02,0x00},
//5
{0x00,0xFE,0xC4,0x64,0x24,0x24,0x64,0xC4,0x00,0x00,0x31,0x60,0x40,0x40,0x40,0x60,0x3F,0x00},
//6
{0x00,0xFC,0x86,0xC2,0xC2,0xC2,0x86,0x1C,0x00,0x00,0x3F,0x61,0x40,0x40,0x40,0x61,0x3F,0x00},
//7
{0x00,0x02,0x02,0x02,0x02,0xC2,0x3A,0x0E,0x00,0x00,0x00,0x00,0x70,0x0E,0x01,0x00,0x00,0x00},
//8
{0x00,0x3C,0xC6,0x82,0x82,0x82,0xC6,0x3C,0x00,0x00,0x3F,0x61,0x40,0x40,0x40,0x61,0x3F,0x00},
//9
{0x00,0xFC,0x86,0x02,0x02,0x02,0x86,0xFC,0x00,0x00,0x38,0x61,0x43,0x43,0x43,0x61,0x3F,0x00}

};


Uint16 per_num[11][16]={
//0
{0xFE,0x0E,0xE6,0xF6,0xF6,0xE6,0x0E,0xFE,0x7F,0x70,0x67,0x6F,0x6F,0x67,0x70,0x7F},
//1
{0xFE,0xDE,0xCE,0x06,0x06,0xFE,0xFE,0xFE,0x7F,0x6F,0x6F,0x60,0x60,0x6F,0x6F,0x7F},
//2
{0xFE,0xCE,0xE6,0xF6,0x76,0x26,0x8E,0xFE,0x7F,0x63,0x69,0x6C,0x6E,0x6F,0x67,0x7F},
//3
{0xFE,0xE6,0xF2,0x7A,0x7A,0xB2,0xC6,0xFE,0x7F,0x67,0x4F,0x5F,0x5F,0x4E,0x61,0x7F},
//4
{0xFE,0x7E,0x3E,0x9E,0xCE,0x06,0xFE,0xFE,0x7F,0x78,0x7B,0x7B,0x7B,0x60,0x7B,0x7F},
//5
{0xFE,0x06,0x6E,0xAE,0xAE,0x2E,0x6E,0xFE,0x7F,0x76,0x67,0x6F,0x6F,0x67,0x70,0x7F},
//6
{0xFE,0x0E,0xE6,0x76,0x76,0x76,0xCE,0xFE,0x7F,0x70,0x66,0x6F,0x6F,0x66,0x70,0x7F},
//7
{0xFE,0xF6,0xF6,0xF6,0x76,0x16,0xC6,0xFE,0x7F,0x7F,0x67,0x71,0x7C,0x7F,0x7F,0x7F},
//8
{0xFE,0x8E,0x26,0x76,0x76,0x26,0x8E,0xFE,0x7F,0x70,0x66,0x6F,0x6F,0x66,0x70,0x7F},
//9
{0xFE,0x0E,0x66,0xF6,0xF6,0x66,0x0E,0xFE,0x7F,0x73,0x6E,0x6E,0x6E,0x67,0x70,0x7F},
//%
{0xFE,0xF6,0xEA,0xF6,0x3E,0xCE,0xF2,0xFE,0x7F,0x4F,0x73,0x7C,0x6F,0x57,0x6F,0x7F}

};

//字母阵列
Uint16 letter[26][9]={
//A
{0x00,0x78,0xCD,0x85,0x85,0xC9,0x7E,0x80,0x00},
//B
{0x00,0x80,0x7F,0xC8,0x88,0x88,0xD8,0x70,0x00},
//C
{0x00,0x7E,0xC3,0x81,0x81,0x81,0xC3,0x42,0x00},
//D
{0x00,0x70,0xD8,0x88,0x88,0xC8,0x7F,0x80,0x00},
//E
{0x00,0x3C,0x4A,0x89,0x89,0x89,0x4A,0x2C,0x00},
//F
{0x00,0x08,0x88,0xFE,0x09,0x09,0x02,0x00,0x00},
//G
{0x00,0x4E,0xDB,0x91,0x91,0x91,0xCB,0x7E,0x00},
//H
{0x00,0x00,0xFF,0x10,0x08,0x08,0xF0,0x00,0x00},
//I
{0x00,0x00,0x00,0x00,0xFD,0x00,0x00,0x00,0x00},
//J
{0x00,0x00,0x00,0x40,0x80,0x7D,0x00,0x00,0x00},
//K
{0x00,0x00,0xFF,0x24,0x62,0xD2,0x9C,0x00,0x00},
//L
{0x00,0x00,0x00,0xFF,0x80,0x40,0x00,0x00,0x00},
//M
{0x00,0xFE,0x01,0x03,0xFE,0x03,0x01,0xFE,0x00},
//N
{0x00,0xFE,0x01,0x01,0x01,0x01,0x01,0xFE,0x00},
//O
{0x00,0x7E,0xC3,0x81,0x81,0x81,0xC3,0x7E,0x00},
//P
{0x00,0xFF,0x1A,0x11,0x11,0x11,0x1B,0x0E,0x00},
//Q
{0x00,0x0E,0x11,0x11,0x11,0xFE,0x80,0x40,0x00},
//R
{0x00,0x00,0xFE,0x18,0x04,0x04,0x02,0x00,0x00},
//S
{0x00,0x66,0x89,0x89,0x89,0x89,0x89,0x72,0x00},
//T
{0x00,0x00,0x04,0x04,0xFF,0x44,0x24,0x00,0x00},
//U
{0x00,0x7F,0xC0,0x80,0x80,0x80,0xC0,0x7F,0x00},
//V
{0x00,0x0F,0x30,0x40,0x80,0x40,0x30,0x0F,0x00},
//W
{0x00,0x7F,0x80,0x40,0x3F,0x40,0x80,0x7F,0x00},
//X
{0x00,0x81,0x42,0x24,0x18,0x24,0x42,0x81,0x00},
//Y
{0x00,0x01,0x02,0x04,0xF8,0x04,0x02,0x01,0x00},
//Z
{0x00,0xC1,0xE1,0xB1,0x99,0x8D,0x87,0x82,0x00}

};


Uint16 addr[8]={0xb4,0xb5,0xb6,0xb7,0xb0,0xb1,0xb2,0xb3};//简化LCD的编程，重新排列page地址


void display(void)
{
	 Uint16	i,j;
	 Uint16 pe=99;
	 Uint16 te=25;
	 	/****** 清屏 ******/
	for(j=0;j<8;j++)
	{
		lcd_w(0,addr[j]);
		lcd_w(0,0x10);
		lcd_w(0,0x00);
		for (i=0;i<128;i++)lcd_w(1,0x00);	
	}
	/*****************/
		
	/***** 分界线 *****/
	//列线
	for(i=0;i<6;i++)
	{
		lcd_w(0,addr[2+i]);
		lcd_w(0,0x12);
		lcd_w(0,0x00);
		lcd_w(1,0xff);
	}
		lcd_w(0,addr[1]);
		lcd_w(0,0x12);
		lcd_w(0,0x00);
		lcd_w(1,0xfc);

	//行线，部分，没包含图标的补线
		lcd_w(0,addr[1]);
		lcd_w(0,0x12);
		lcd_w(0,0x01);						
		for(i=0;i<111;i++)lcd_w(1,0x04);

	/*****************/

	/***** 顶上图标 ******/
	if(mod==0)
	{
		if(rev!=0)disp_pic(0);//fn_fg:使用参数校正功能							

		if(status==2)disp_pic(3);// rn_fg:泵转

		//if()disp_pic(2);//堵塞标志??	

		if(((zz*10000)/flow)<errer && status==2)disp_pic(1);//错误标志							
	}

	//显示电池
	lcd_w(0,addr[0]);
	lcd_w(0,0x16);
	lcd_w(0,0x08);
	for(i=0;i<20;i++)lcd_w(1,dc[i]);//dc图标,根据电池的电量改变数组值

	/*****************/

	/******** 左侧图标 *********/
	switch(mod)
	{
		case run_fg:disp_lf(2,0);//左侧 RUN 
					if(status==2 && pe!=0)disp_per(pe);//%减计数，如果等于0即正常完成则消失
					break;
	
		case set_fg:disp_lf(4,1);//左侧SYS
					break;

		case fun_fg:disp_lf(6,2);//左侧FUN
					break;

		default:	break;
	}

		//显示标识符
	if(mod==0)//运行菜单
	{
	switch(run_i)//要求mod=RUN，同时上翻下翻的显示
	{
		case te_fg:	disp_bsf(0,3);//设置值
					disp_bsf(1,4);//

					disp_dw(4,1);//min
					disp_dw(7,0);//slm
					break;

		case ft_fg:	disp_bsf(0,1);//时间--流量
					disp_bsf(1,0);//

					disp_dw(4,1);//min
					disp_dw(7,0);//slm
					break;

		case sf_fg:	disp_bsf(0,2);//温度--流量
					disp_bsf(1,0);//

					disp_dw(4,2);//温度
					disp_dw(7,0);//slm
					break;

		default:	break;
	}
	}
	else if(mod==1)//设置菜单
	{	
		disp_bsf(2,0);//温度--流量
		disp_bsf(4,1);//
		disp_bsf(6,2);//

		disp_dw(3,0);//温度
		disp_dw(5,1);//slm
		disp_dw(7,2);//slm
	}

	if(mod==2)//功能菜单
	{
		disp_letter(2,2);
		disp_letter(4,0);
		disp_letter(6,1);

		disp_num(6,((float)errer)/100);

	}

	//显示数字
	if(mod==1)//设置菜单
	{
		disp_num(2,((float)flow)/100);//进入菜单默认设置
		disp_num(4,((float)time)/100);//
		disp_num(6,((float)rev)/100);//	
	}
	else if(mod==0)
	{	
		disp_num(3,((float)te)/100);
		disp_num(6,zz);
	}				
	
}


//顶上图标
void disp_pic(Uint16 sel)
{
	Uint16	i;

	lcd_w(0,addr[0]);
	lcd_w(0,0x12+sel);
	lcd_w(0,0x00);
	for(i=0;i<14;i++)lcd_w(1,pic_f[sel][i]);//rn图标
	//补充行线
	lcd_w(0,addr[1]);
	lcd_w(0,0x12+sel);
	lcd_w(0,0x00);
	if(sel==0)lcd_w(1,0xfd);//补全断线，fn影响部分列线
	for(i=0;i<14;i++)lcd_w(1,0x05);

}

//百分比
void disp_per(Uint16 perc)
{
	Uint16	i,j,k;
	
	Uint16 temp[3];

	temp[0]=(perc%100/10);
	temp[1]=(perc%10);
	temp[2]=10;

	for(i=0;i<2;i++)//占用2个page
	{
		lcd_w(0,addr[6+i]);//显示的位置
		lcd_w(0,0x10);
		lcd_w(0,0x03);

		for(k=0;k<3;k++)//显示2位数据
		{
			if(i)lcd_w(1,0x7f);
			else lcd_w(1,0xfe);
			for(j=i*8;j<8*(i+1);j++)lcd_w(1,per_num[temp[k]][j]);
			
		}
		if(i)lcd_w(1,0x7f);
		else lcd_w(1,0xfe);
	}
}


//RUN Set fuc
void disp_lf(Uint16 z,Uint16 sel)
{
	Uint16	i,j;

	for(i=0;i<2;i++)//占用2个page
	{
		lcd_w(0,addr[z+i]);//显示的位置
		lcd_w(0,0x10);
		lcd_w(0,0x00);
		for(j=i*32;j<32*(i+1);j++)lcd_w(1,lf[sel][j]);
	}
}


//标识符
void disp_bsf(Uint16 ud,Uint16 sel)
{
	Uint16	i,j;
	Uint16 z;
	
	if(mod==0)
	{	
		if(ud==0)z=2;//显示的位置
		else z=5;
	}
	else z=ud;

	if(mod==1)
	{

		for(i=0;i<2;i++)//menu_sel菜单选择
		{
			lcd_w(0,addr[i+2*(menu+1)]);//显示的位置
			lcd_w(0,0x12);
			lcd_w(0,0x02);
			for(j=i*4;j<4*(i+1);j++)lcd_w(1,menu_sel[j]);
		}

		for(i=0;i<2;i++)//占用2个page
		{
			lcd_w(0,addr[z+i]);//显示的位置
			lcd_w(0,0x12);
			lcd_w(0,0x06);
			for(j=i*24;j<24*(i+1);j++)lcd_w(1,bsf_set[sel][j]);
		}
	}
	else if(mod==0)
	{
		for(i=0;i<3;i++)//占用3个page
		{
			lcd_w(0,addr[z+i]);//显示的位置
			lcd_w(0,0x12);
			lcd_w(0,0x01);
			for(j=i*32;j<32*(i+1);j++)lcd_w(1,bsf_run[sel][j]);
		}
	}
}

//显示单位
void disp_dw(Uint16 ud,Uint16 sel)
{
	Uint16	j;

	lcd_w(0,addr[ud]);//显示的位置
	lcd_w(0,0x16);
	lcd_w(0,0x01);
	for(j=0;j<24;j++)lcd_w(1,dw[sel][j]);
}

//数据
void disp_num(Uint16 z,float w)
{
	Uint16	i,j,k;
	Uint16 ud;

	Uint16 temp[3];
	Uint16 x;

	x=w/1;
	w=(w-x)*100;

	temp[0]=(x%10);
	temp[1]=((int)w%100/10);
	temp[2]=((int)w%10);

	for(i=0;i<2;i++)//占用2个page
	{
		lcd_w(0,addr[z+i]);//显示的位置
		lcd_w(0,0x14);
		lcd_w(0,0x01);

		if(w<0)lcd_w(1,0xff);
									
		for(k=0;k<3;k++)//显示3位数据
		{
			for(j=i*9;j<9*(i+1);j++)lcd_w(1,num[temp[k]][j]);

			if(mod==0)ud=6;
			else if(mod==1)ud=2;

			if(k==0 && i==0 && z==ud)
				for(j=0;j<2;j++)lcd_w(1,0x00);//上面空间对齐
			if(k==0 && i==1 && z==ud)
				for(j=0;j<2;j++)lcd_w(1,0x60);//下面小数点
		}
	}
}


//显示字母
void disp_letter(Uint16 ud,Uint16 sel)
{
	Uint16	i,j,k;
	Uint16 temp[3];

	switch(sel)
	{
		case 0:
				temp[0]=17;//r
				temp[1]=18;//s
				temp[2]=19;//t
				break;
		case 1:
				temp[0]=4;//e
				temp[1]=17;//r
				temp[2]=17;//r
				break;
		case 2:
				temp[0]=1;//
				temp[1]=2;//
				temp[2]=3;//
				break;
		default:break;
	}

	for(i=0;i<2;i++)//menu_sel菜单选择
	{
		lcd_w(0,addr[i+2*(menu+1)]);//显示的位置
		lcd_w(0,0x12);
		lcd_w(0,0x02);
		for(j=i*4;j<4*(i+1);j++)lcd_w(1,menu_sel[j]);
	}

	lcd_w(0,addr[ud]);//显示的位置
	lcd_w(0,0x12);
	lcd_w(0,0x06);
	for(k=0;k<3;k++)//显示3位数据
		for(j=0;j<9;j++)lcd_w(1,letter[temp[k]][j]);
	
}



//显示图片
void disp_bmp()
{
	Uint16 i=0,j=0;

	for(j=0;j<4;j++)
	{
		lcd_w(0,addr[4+j]);
		lcd_w(0,0x10);
		lcd_w(0,0x00);
		for(i=0;i<128;i++)
		{
			lcd_w(1,tab1[i+j*128+512]);
		}
	}

	for(j=0;j<4;j++)
	{
		lcd_w(0,addr[0+j]);
		lcd_w(0,0x10);
		lcd_w(0,0x00);
		for(i=0;i<128;i++)
		{
			lcd_w(1,tab1[i+j*128]);
		}
	}
}


void	lcd_w(Uint16 sel,Uint16 dat)	//sel:1写数据，0写命令
{
	Uint16	i;
	lcd_a0 = sel;

	for	(i=0;i<8;i++)
		{
			if ((dat & 0x80)==0) dat_clr;//数据送0
			else dat_set;				//数据送1
			dat <<= 1;					//左移？右移？我的164是左移，板的程序右移				
			clk_clr;					//CLK低电平
			clk_set;					//CLK高电平
		}
}


void	lcd_Init(void)
{
	lcd_w(0,0xE2);		//DB	11100010B		;RESET
	lcd_w(0,0x2C);		//DB	00101100B
	lcd_w(0,0x2E);
	lcd_w(0,0x2F);		//DB	00101111B		;SET POWER CONTROL
	lcd_w(0,0xA3);		//DB	10100011B		;SET LCD BIAS
	
	lcd_w(0,0x24);		//DB	00100100B		;SET V5 VOLTAGE RATIO
	lcd_w(0,0x81);		//DB	10000001B		;SET ELECTRONIC VOLUME MODE
	lcd_w(0,0x20);		//DB	00110010B		;SET ELECTRONIC VOLUME REGISTER
	
	lcd_w(0,0x00);		//DB	00000000B		;INITIAL DISPLAY LINE
	lcd_w(0,0xa0);		//DB	10100000B		;ADC SELECT
	lcd_w(0,0xC8);		//DB	11000000B		;COMMON OUTPUT MODE
	lcd_w(0,0xA2);		//DB	10100010B		;DISPLAY ALL POINTS OFF
	lcd_w(0,0xA6);		//DB	10100110B		;NORMAL DISPLAY
	lcd_w(0,0xAD);       //                      ;STATIC INDICATOR
	lcd_w(0,0x00);
	lcd_w(0,0xAF);		//DB	10101111B		;DISPLAY ON
	lcd_w(0,0xAF);		//DB	10101111B
	lcd_w(0,0x03);		//DB	00000011B 
}	

		
//===========================================================================
// No more.
//===========================================================================
