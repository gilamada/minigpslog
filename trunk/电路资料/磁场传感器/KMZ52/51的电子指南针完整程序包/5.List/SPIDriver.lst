C51 COMPILER V8.08   SPIDRIVER                                                             06/18/2008 01:56:57 PAGE 1   


C51 COMPILER V8.08, COMPILATION OF MODULE SPIDRIVER
OBJECT MODULE PLACED IN .\4.Obj\SPIDriver.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE 3.Source\SPIDriver.c BROWSE INCDIR(.\2.Inc) DEBUG OBJECTEXTEND PRINT(.\5.Li
                    -st\SPIDriver.lst) OBJECT(.\4.Obj\SPIDriver.obj)

line level    source

   1          /*
   2          **********************************************************************************************************
             -********************
   3          ***模块名称：SPIDrvier
   4          ***功    能：SPI驱动包
   5          ***作    者：METAL MAX
   6          ***创建日期：
   7          ***备    注:
   8          ***日    志:
   9          ***
  10          **********************************************************************************************************
             -********************
  11          */
  12          #include <reg52.h>
  13          #include "PinDefine.h"
  14          #include <intrins.h>
  15          
  16          
  17          
  18          /*********************************************************************************************************
             -*******************
  19          **函数名称：SPISendByte                                                                                   
             -                 **
  20          **函数功能：发送一字节                                                                                    
             -                 **   
  21          **入口参数：要发送的字节                                                                                  
             -                 **
  22          **出口参数：无                                                                                            
             -                 **
  23          **具体资源：无                                                                                            
             -                 **
  24          **调用程序：无                                                                                            
             -                 **
  25          **备    注：最高位先发送                                                                                  
             -                 **
  26          **********************************************************************************************************
             -******************/
  27          unsigned char SPIRcv(void)
  28          {
  29   1          unsigned char Cnt,tmp,Dat;
  30   1          
  31   1          SSNOT = 0;
  32   1          CLK_SPI = 0;
  33   1          _nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_(
             -);
  34   1          _nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_(
             -);
  35   1          _nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_(
             -);
  36   1          
  37   1          do {
  38   2              CLK_SPI = 1;
  39   2              _nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_n
             -op_();
C51 COMPILER V8.08   SPIDRIVER                                                             06/18/2008 01:56:57 PAGE 2   

  40   2              _nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_n
             -op_();
  41   2              tmp = MOSI;
  42   2              Dat = Dat << 1;
  43   2              Dat = Dat | tmp;
  44   2              Cnt++;
  45   2              CLK_SPI = 0;
  46   2              _nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_n
             -op_();
  47   2          }while (Cnt != 8);
  48   1          MOSI = 1;
  49   1          SSNOT = 1;    
  50   1          return(Dat);
  51   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    110    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
